import{B as U,J as P,M as E,R as k,V as O,a as S,d as J,r as f,u as F,C as H,b as K,o as Q,c as W,e as X,w as B,_ as Y,f as g,g as v,h as C,i as t,j as M,v as N,t as V,k as Z,l as b,F as ee,m as te}from"./index-B6yYn_6W.js";class ae extends U{async apiV1TagsGetRaw(e,s){const o={};e.withBookmarkCount!=null&&(o.with_bookmark_count=e.withBookmarkCount),e.bookmarkId!=null&&(o.bookmark_id=e.bookmarkId),e.search!=null&&(o.search=e.search);const r={},u=await this.request({path:"/api/v1/tags",method:"GET",headers:r,query:o},s);return new P(u,w=>w.map(E))}async apiV1TagsGet(e={},s){return await(await this.apiV1TagsGetRaw(e,s)).value()}async apiV1TagsIdDeleteRaw(e,s){if(e.id==null)throw new k("id",'Required parameter "id" was null or undefined when calling apiV1TagsIdDelete().');const o={},r={},u=await this.request({path:"/api/v1/tags/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"DELETE",headers:r,query:o},s);return new O(u)}async apiV1TagsIdDelete(e,s){await this.apiV1TagsIdDeleteRaw(e,s)}async apiV1TagsIdGetRaw(e,s){if(e.id==null)throw new k("id",'Required parameter "id" was null or undefined when calling apiV1TagsIdGet().');const o={},r={},u=await this.request({path:"/api/v1/tags/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:r,query:o},s);return new P(u,w=>E(w))}async apiV1TagsIdGet(e,s){return await(await this.apiV1TagsIdGetRaw(e,s)).value()}async apiV1TagsIdPutRaw(e,s){if(e.id==null)throw new k("id",'Required parameter "id" was null or undefined when calling apiV1TagsIdPut().');if(e.tag==null)throw new k("tag",'Required parameter "tag" was null or undefined when calling apiV1TagsIdPut().');const o={},r={};r["Content-Type"]="application/json";const u=await this.request({path:"/api/v1/tags/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"PUT",headers:r,query:o,body:S(e.tag)},s);return new P(u,w=>E(w))}async apiV1TagsIdPut(e,s){return await(await this.apiV1TagsIdPutRaw(e,s)).value()}async apiV1TagsPostRaw(e,s){if(e.tag==null)throw new k("tag",'Required parameter "tag" was null or undefined when calling apiV1TagsPost().');const o={},r={};r["Content-Type"]="application/json";const u=await this.request({path:"/api/v1/tags",method:"POST",headers:r,query:o,body:S(e.tag)},s);return new P(u,w=>E(w))}async apiV1TagsPost(e,s){return await(await this.apiV1TagsPostRaw(e,s)).value()}}const se=J("tags",()=>{const h=f([]),e=f(!1),s=f(null),o=()=>{const n=F().token,l=new H({basePath:"http://localhost:8080",accessToken:n||void 0,headers:n?{Authorization:`Bearer ${n}`}:void 0});return new ae(l)};return{tags:h,isLoading:e,error:s,fetchTags:async(c=!0)=>{e.value=!0,s.value=null;try{const l=await o().apiV1TagsGet({withBookmarkCount:c});return Array.isArray(l)?h.value=l:(console.error("Expected array response but got:",typeof l),h.value=[]),h.value}catch(n){throw console.error("Failed to fetch tags:",n),n instanceof Error&&n.message.includes("401")?s.value="Authentication error. Please log in again.":s.value="Failed to load tags. Please try again.",n}finally{e.value=!1}},createTag:async c=>{e.value=!0,s.value=null;try{const l=await o().apiV1TagsPost({tag:{name:c}});return h.value.push(l),l}catch(n){throw console.error("Failed to create tag:",n),n instanceof Error&&n.message.includes("401")?s.value="Authentication error. Please log in again.":s.value="Failed to create tag. Please try again.",n}finally{e.value=!1}},updateTag:async(c,n)=>{e.value=!0,s.value=null;try{const m=await o().apiV1TagsIdPut({id:c,tag:{id:c,name:n}}),y=h.value.findIndex(p=>p.id===c);return y!==-1&&(h.value[y]=m),m}catch(l){throw console.error("Failed to update tag:",l),l instanceof Error&&l.message.includes("401")?s.value="Authentication error. Please log in again.":s.value="Failed to update tag. Please try again.",l}finally{e.value=!1}},deleteTag:async c=>{e.value=!0,s.value=null;try{await o().apiV1TagsIdDelete({id:c}),h.value=h.value.filter(l=>l.id!==c)}catch(n){throw console.error("Failed to delete tag:",n),n instanceof Error&&n.message.includes("401")?s.value="Authentication error. Please log in again.":s.value="Failed to delete tag. Please try again.",n}finally{e.value=!1}}}}),oe={class:"flex justify-between items-center"},ne={class:"flex space-x-2"},le={key:0,class:"bg-white p-4 rounded-md shadow-sm mb-6"},re=["disabled"],ie={key:0,class:"mt-1 text-sm text-red-600"},de={class:"flex justify-end space-x-2"},ue=["disabled"],ce=["disabled"],ge={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6"},pe={key:2,class:"bg-white p-6 rounded-md shadow-sm flex justify-center"},ve={key:3,class:"bg-white p-6 rounded-md shadow-sm text-center"},he={key:4,class:"mt-6"},we={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},me={key:0,class:"flex items-center"},fe=["disabled"],ye={class:"flex ml-2 space-x-1"},be=["onClick","disabled"],xe=["disabled"],Te={key:1,class:"flex items-center"},ke={class:"flex-1"},Ce={class:"font-medium text-lg"},Ve={class:"text-sm text-gray-500"},_e={class:"flex space-x-1"},Re=["onClick"],Ie=["onClick"],Pe={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ee={class:"bg-white rounded-lg p-6 max-w-md w-full"},De={class:"flex justify-end space-x-3"},Se=K({__name:"TagsView",setup(h){const e=se(),s=F(),o=W(),{tags:r,isLoading:u,error:w,fetchTags:D,createTag:c,updateTag:n,deleteTag:l}=e,m=f(!1),y=f(""),p=f(!1),_=f(null),R=f(null),x=f("");Q(async()=>{try{s.isAuthenticated?await D():await s.validateToken()?(await D(),console.log("tags",r)):(s.setRedirectDestination("/tags"),o.push("/login"))}catch(i){i instanceof Error&&i.message.includes("401")&&(s.setRedirectDestination("/tags"),o.push("/login"))}});const A=i=>{i instanceof Error&&i.message.includes("401")&&(s.setRedirectDestination("/tags"),o.push("/login"))},L=async()=>{if(!y.value.trim()){_.value="Tag name cannot be empty";return}_.value=null,p.value=!0;try{await c(y.value.trim()),y.value="",m.value=!1}catch(i){A(i)}finally{p.value=!1}},$=(i,a)=>{R.value=i,x.value=a},z=()=>{R.value=null,x.value=""},q=async i=>{if(x.value.trim()){p.value=!0;try{await n(i,x.value.trim()),R.value=null}catch(a){A(a)}finally{p.value=!1}}},T=f(null),G=i=>{T.value=i},j=async()=>{if(T.value!==null)try{await l(T.value),T.value=null}catch(i){A(i)}};return(i,a)=>(g(),X(Y,null,{header:B(()=>[t("div",oe,[a[6]||(a[6]=t("h1",{class:"text-xl font-bold"},"Tags",-1)),t("div",ne,[t("button",{onClick:a[0]||(a[0]=d=>m.value=!m.value),class:"bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 transition"},V(m.value?"Cancel":"New Tag"),1)])])]),default:B(()=>[m.value?(g(),v("div",le,[a[8]||(a[8]=t("h2",{class:"text-lg font-medium mb-3"},"Create New Tag",-1)),t("form",{onSubmit:Z(L,["prevent"]),class:"flex flex-col space-y-3"},[t("div",null,[a[7]||(a[7]=t("label",{for:"tagName",class:"block text-sm font-medium text-gray-700 mb-1"},"Tag Name",-1)),M(t("input",{id:"tagName","onUpdate:modelValue":a[1]||(a[1]=d=>y.value=d),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter tag name",disabled:p.value},null,8,re),[[N,y.value]]),_.value?(g(),v("p",ie,V(_.value),1)):C("",!0)]),t("div",de,[t("button",{type:"button",onClick:a[2]||(a[2]=d=>m.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:p.value}," Cancel ",8,ue),t("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50",disabled:p.value}," Create ",8,ce)])],32)])):C("",!0),b(w)?(g(),v("div",ge,V(b(w)),1)):C("",!0),b(u)&&!b(r).length?(g(),v("div",pe,a[9]||(a[9]=[t("div",{class:"animate-pulse text-gray-500"},"Loading tags...",-1)]))):!b(u)&&!b(r).length?(g(),v("div",ve,[a[10]||(a[10]=t("p",{class:"text-gray-500 mb-4"},"No tags found. Create your first tag to organize your bookmarks.",-1)),m.value?C("",!0):(g(),v("button",{key:0,onClick:a[3]||(a[3]=d=>m.value=!0),class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600"}," Create Tag "))])):(g(),v("div",he,[t("ul",we,[(g(!0),v(ee,null,te(b(r),d=>(g(),v("li",{key:d.id,class:"bg-white p-4 rounded-md shadow-sm hover:shadow-md transition-shadow border border-gray-200"},[R.value===d.id?(g(),v("div",me,[M(t("input",{"onUpdate:modelValue":a[4]||(a[4]=I=>x.value=I),type:"text",class:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p.value},null,8,fe),[[N,x.value]]),t("div",ye,[t("button",{onClick:I=>q(d.id),class:"text-blue-500 hover:text-blue-700 p-1",disabled:p.value,title:"Save"},a[11]||(a[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]),8,be),t("button",{onClick:z,class:"text-gray-500 hover:text-gray-700 p-1",disabled:p.value,title:"Cancel"},a[12]||(a[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,xe)])])):(g(),v("div",Te,[a[15]||(a[15]=t("div",{class:"mr-3 text-blue-400"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})])],-1)),t("div",ke,[t("h3",Ce,V(d.name),1),t("p",Ve,V(d.bookmarkCount||0)+" bookmarks",1)]),t("div",_e,[t("button",{onClick:I=>$(d.id,d.name),class:"text-gray-400 hover:text-gray-600 p-1",title:"Edit"},a[13]||(a[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]),8,Re),t("button",{onClick:I=>G(d.id),class:"text-gray-400 hover:text-red-500 p-1",title:"Delete"},a[14]||(a[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,Ie)])]))]))),128))])])),T.value!==null?(g(),v("div",Pe,[t("div",Ee,[a[16]||(a[16]=t("h3",{class:"text-lg font-medium mb-4"},"Confirm Delete",-1)),a[17]||(a[17]=t("p",{class:"mb-6"},"Are you sure you want to delete this tag? This action cannot be undone.",-1)),t("div",De,[t("button",{onClick:a[5]||(a[5]=d=>T.value=null),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel "),t("button",{onClick:j,class:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600"}," Delete ")])])])):C("",!0)]),_:1}))}});export{Se as default};
